# -*- coding: utf-8 -*-
"""
Created on Thu Jan 12 16:49:37 2023

@author: fgrimald
"""
import numpy as np
from SEAT.nuclides import expand_zam

## Natural abundances in atomic fractions
H = {'H1': 99.9885e-2, 'H2': 0.0115e-2}
He = {'He3': 0.000137e-2, 'He4': 99.999863e-2}
Li = {'Li6': 7.59e-2, 'Li7': 92.41e-2}
Be = {'Be9': 100e-2}
B = {'B10': 19.9e-2, 'B11': 80.1e-2}
C = {'C12': 98.93e-2, 'C13': 1.07e-2}
N = {'N14': 99.632e-2, 'N15': 0.368e-2}
O = {'O16': 99.757e-2, 'O17': 0.038e-2, 'O18': 0.205e-2}
F = {'F19': 100e-2}
Ne = {'Ne20': 90.48e-2, 'Ne21': 0.27e-2, 'Ne22': 9.25e-2}
Na = {'Na23': 100e-2}
Mg = {'Mg24': 78.99e-2, 'Mg25': 10.00e-2, 'Mg26': 11.01e-2}
Al = {'Al27': 100e-2}
Si = {'Si28': 92.2297e-2, 'Si29': 4.6832e-2, 'Si30': 3.0872e-2}
P = {'P31': 100e-2}
S = {'S32': 94.93e-2, 'S33':0.76e-2, 'S34': 4.29e-2, 'S36': 0.02e-2}
Cl = {'Cl35': 75.78e-2, 'Cl37': 24.22e-2}
Ar = {'Ar36': 0.33605e-2, 'Ar38':0.0632e-2, 'Ar40': 99.6003e-2}
K = {'K39': 93.2581e-2, 'K40': 0.0117e-2, 'K41': 6.7302e-2}
Ca = {'Ca40': 96.941e-2, 'Ca42': 0.647e-2, 'Ca43': 0.135e-2, 'Ca44': 2.086e-2, 'Ca46': 0.004e-2, 'Ca48': 0.187e-2}
Sc = {'Sc45': 100e-2}
Ti = {'Ti46': 8.25e-2, 'Ti47': 7.44e-2, 'Ti48': 73.72e-2, 'Ti49': 5.41e-2, 'Ti50': 5.18e-2}
Va = {'V50': 0.250e-2, 'V51': 99.750e-2}
Cr = {'Cr50': 4.345e-2, 'Cr52': 83.789e-2, 'Cr53': 9.501e-2, 'Cr54': 2.365e-2}
Mn = {'Mn55': 100e-2}
Fe = {'Fe54': 5.845e-2, 'Fe56': 91.754e-2, 'Fe57': 2.119e-2, 'Fe58': 0.282e-2}
Co = {'Co59': 100e-2}
Ni = {'Ni58': 68.0769e-2, 'Ni60': 26.2231e-2, 'Ni61': 1.1399e-2, 'Ni62':3.6345e-2, 'Ni64': 0.9256e-2}
Cu = {'Cu63': 69.17e-2, 'Cu65': 30.83e-2}
Zn = {'Zn64': 48.63e-2, 'Zn66': 27.90e-2, 'Zn67': 4.10e-2, 'Zn68': 18.75e-2, 'Zn70': 0.62e-2}
Ga = {'Ga69': 60.108e-2, 'Ga71': 39.892e-2}
Ge = {'Ge70': 20.84e-2, 'Ge72': 27.54e-2, 'Ge73': 7.73e-2, 'Ge74': 36.28e-2, 'Ge76': 7.61e-2}
As = {'As75': 100e-2}
Se = {'Se74': 0.89e-2, 'Se76': 9.37e-2, 'Se77': 7.63e-2, 'Se78': 23.77e-2, 'Se80': 49.61e-2, 'Se82': 8.73e-2}
Br = {'Br79': 50.69e-2, 'Br81': 49.31e-2}
Kr = {'Kr78': 0.35e-2, 'Kr80': 2.28e-2, 'Kr82': 11.58e-2, 'Kr83': 11.49e-2, 'Kr84': 57.00e-2, 'Kr86': 17.30e-2}
Rb = {'Rb85': 72.17e-2, 'Rb87': 27.83e-2}
Sr = {'Sr84': 0.56e-2, 'Sr86': 9.86e-2, 'Sr87': 7.00e-2, 'Sr88': 82.58e-2}
Y = {'Y89': 100e-2}
Zr = {'Zr90': 51.45e-2, 'Zr91': 11.22e-2, 'Zr92': 17.15e-2, 'Zr94': 17.38e-2, 'Zr96': 2.80e-2}
Nb = {'Nb93': 100e-2}
Mo = {'Mo92': 14.84e-2, 'Mo94': 9.25e-2, 'Mo95': 15.92e-2, 'Mo96': 16.68e-2, 'Mo97': 9.55e-2, 'Mo98': 24.13e-2, 'Mo100': 9.63e-2}
Tc = {'Tc98': np.nan}
Ru = {'Ru96': 5.54e-2, 'Ru98': 1.87e-2, 'Ru99': 12.76e-2, 'Ru100': 12.6e-2, 'Ru101': 17.06e-2, 'Ru102': 31.55e-2, 'Ru104': 18.62e-2}
Rh = {'Rh103': 100e-2}
Pd = {'Pd102': 1.02e-2, 'Pd104': 11.14e-2, 'Pd10': 22.33e-2, 'Pd106': 27.33e-2, 'Pd108': 26.46e-2, 'Pd110': 11.72e-2}
Ag = {'Ag107': 51.839e-2, 'Ag109': 48.161e-2}
Cd = {'Cd106': 1.25e-2, 'Cd108': 0.89e-2, 'Cd110': 12.49e-2, 'Cd111': 12.80e-2, 'Cd112': 24.13e-2, 'Cd113': 12.22e-2, 'Cd114': 28.73e-2, 'Cd116': 7.49e-2}
In = {'In113': 4.29e-2, 'In115': 95.71e-2}
Sn = {'Sn112': 0.97e-2, 'Sn114': 0.66e-2, 'Sn115': 0.34e-2, 'Sn116': 14.54e-2, 'Sn117': 7.68e-2, 'Sn118': 24.22e-2, 'Sn119': 8.59e-2, 'Sn120': 32.58e-2, 'Sn122': 4.63e-2, 'Sn124': 5.79e-2}
Sb = {'Sb121': 57.21e-2, 'Sb123': 42.79e-2}
Te = {'Te120': 0.09e-2, 'Te122': 2.55e-2, 'Te123': 0.89e-2, 'Te124': 4.74e-2, 'Te125': 7.07e-2, 'Te126': 18.84e-2, 'Te128': 31.74e-2, 'Te130': 34.08e-2}
I = {'I127': 100e-2}
Xe = {'Xe124': 0.09e-2, 'Xe126': 0.09e-2, 'Xe128': 1.92e-2, 'Xe129': 26.44e-2, 'Xe130': 4.08e-2, 'Xe131': 21.18e-2, 'Xe132': 26.89e-2, 'Xe134': 10.44e-2, 'Xe136': 8.87e-2}
Cs = {'Cs133': 100e-2}
Ba = {'Ba130': 0.106e-2, 'Ba132': 0.101e-2, 'Ba134': 2.417e-2, 'Ba135': 6.592e-2, 'Ba136': 7.854e-2, 'Ba137': 11.232e-2, 'Ba138': 71.698e-2}
La = {'La138': 0.090e-2, 'La139': 99.910e-2}
Ce = {'Ce136': 0.185e-2, 'Ce138': 0.251e-2, 'Ce140': 88.450e-2, 'Ce142': 11.114e-2}
Pr = {'Pr141': 100e-2}
Nd = {'Nd142': 27.2e-2, 'Nd143': 12.2e-2, 'Nd144': 23.8e-2, 'Nd145': 8.3e-2, 'Nd146': 17.2e-2, 'Nd148': 5.7e-2, 'Nd150': 5.6e-2}
Pm = {'Pm145': 100e-2}
Sm = {'Sm144': 3.07e-2, 'Sm147': 14.99e-2, 'Sm148': 11.24e-2, 'Sm149': 13.82e-2, 'Sm150': 7.38e-2, 'Sm152': 26.75e-2, 'Sm154': 22.75e-2}
Eu = {'Eu151': 47.81e-2, 'Eu153': 52.19e-2}
Gd = {'Gd152': 0.20e-2, 'Gd154': 2.18e-2, 'Gd155': 14.80e-2, 'Gd156': 20.47e-2, 'Gd157': 15.65e-2, 'Gd158': 24.84e-2, 'Gd160': 21.86e-2}
Tb = {'Tb159': 100e-2}
Dy = {'Dy156': 0.06e-2, 'Dy158': 0.10e-2, 'Dy160': 2.34e-2, 'Dy161': 18.91e-2, 'Dy162': 25.51e-2, 'Dy163': 24.90e-2, 'Dy164': 28.18e-2}
Ho = {'Ho165': 100e-2}
Er = {'Er162': 0.14e-2, 'Er164': 1.61e-2, 'Er166': 33.61e-2, 'Er167': 22.93e-2, 'Er168': 26.78e-2, 'Er170': 14.93e-2}
Tm = {'Tm169': 100e-2}
Yb = {'Y168': 0.13e-2, 'Y170': 3.04e-2, 'Y171': 14.28e-2, 'Y172': 21.83e-2, 'Y173': 16.13e-2, 'Y174': 31.83e-2, 'Y176': 12.76e-2}
Lu = {'Lu175': 97.41e-2, 'Lu176': 2.59e-2}
Hf = {'Hf174': 0.16e-2, 'Hf176': 5.26e-2, 'Hf177': 18.60e-2, 'Hf178': 27.28e-2, 'Hf179': 13.62e-2, 'H180': 35.08e-2}
Ta = {'Ta180': 0.012e-2, 'Ta181': 99.988e-2}
W = {'W180': 0.12e-2, 'W182': 26.50e-2, 'W183': 14.31e-2, 'W184': 30.64e-2, 'W186': 28.43e-2}
Re = {'Re185': 37.40e-2, 'Re187': 62.60e-2}
Os = {'Os184': 0.02e-2, 'Os186': 1.59e-2, 'Os187': 1.96e-2, 'Os188': 13.24e-2, 'Os189': 16.15e-2, 'Os190': 26.26e-2, 'Os192': 40.78e-2}
Ir = {'Ir191': 37.3e-2, 'Ir193': 62.7e-2}
Pt = {'Pt190': 0.014e-2, 'Pt192': 0.782e-2, 'Pt194': 32.967e-2, 'Pt195': 33.832e-2, 'Pt196': 25.242e-2, 'Pt198': 7.163e-2}
Au = {'Au197': 100e-2}
Hg = {'Hg196': 0.15e-2, 'Hg198': 9.97e-2, 'Hg199': 16.87e-2, 'Hg200': 23.10e-2, 'Hg201': 13.18e-2, 'Hg202': 29.86e-2, 'Hg204': 6.87e-2}
Tl = {'Tl203': 29.524e-2, 'Tl205': 70.476e-2}
Pb = {'Pb204': 1.378e-2, 'Pb206': 23.956e-2, 'Pb207': 22.074e-2, 'Pb208': 52.592e-2}
Bi = {'Bi209': 100e-2}
Po = {'Po209': np.nan}
At = {'At210': np.nan}
Rn = {'Rn222': np.nan}
Fr = {'Fr223': np.nan}
Ra = {'Ra226': np.nan}
Ac = {'Ac227': np.nan}
Th = {'Th232': 100e-2}
Pa = {'Pa231': 100e-2}
U = {'U238': 99.274e-2, 'U235': 0.720e-2, 'U234': 0.005e-2}
Np = {'Np237': np.nan}
Pu = {'Pu244': np.nan}
Am = {'Am2430': np.nan}
Cm = {'Cm247': np.nan}
Bk = {'Bk247': np.nan}
Cf = {'Cf251': np.nan}
Es = {'Es252': np.nan}
Fm = {'Fm257': np.nan}
Md = {'Md258': np.nan}
No = {'No259': np.nan}
Lr = {'Lr262': np.nan}
Rf = {'Rf263': np.nan}
Db = {'Db262': np.nan}
Sg = {'Sg266': np.nan}
Bh = {'Bh264': np.nan}
Hs = {'Hs269': np.nan}
Mt = {'Mt268': np.nan}
Uun = {'Uun272': np.nan}
Uuu = {'Uuu272': np.nan}
Uub = {'Uub277': np.nan}
Uuq  = {'Uub289': np.nan}
Uuh = {'Uuh2889': np.nan}
Uuo = {'Uuo293': np.nan}

NATURAL_ABUNDANCE = {
    10010: 0.99984426,
    10020: 0.00015574,
    20030: 2e-06,
    20040: 0.999998,
    30060: 0.07589,
    30070: 0.92411,
    40090: 1.0,
    50100: 0.1982,
    50110: 0.8018,
    60120: 0.988922,
    60130: 0.011078,
    70140: 0.996337,
    70150: 0.003663,
    80160: 0.9976206,
    80170: 0.000379,
    80180: 0.0020004,
    90190: 1.0,
    100200: 0.9048,
    100210: 0.0027,
    100220: 0.0925,
    110230: 1.0,
    120240: 0.78951,
    120250: 0.1002,
    120260: 0.11029,
    130270: 1.0,
    140280: 0.9222968,
    140290: 0.0468316,
    140300: 0.0308716,
    150310: 1.0,
    160320: 0.9504074,
    160330: 0.0074869,
    160340: 0.0419599,
    160360: 0.0001458,
    170350: 0.757647,
    170370: 0.242353,
    180360: 0.003336,
    180380: 0.000629,
    180400: 0.996035,
    190390: 0.932581,
    190400: 0.000117,
    190410: 0.067302,
    200400: 0.96941,
    200420: 0.00647,
    200430: 0.00135,
    200440: 0.02086,
    200460: 4e-05,
    200480: 0.00187,
    210450: 1.0,
    220460: 0.0825,
    220470: 0.0744,
    220480: 0.7372,
    220490: 0.0541,
    220500: 0.0518,
    230500: 0.0025,
    230510: 0.9975,
    240500: 0.04345,
    240520: 0.83789,
    240530: 0.09501,
    240540: 0.02365,
    250550: 1.0,
    260540: 0.05845,
    260560: 0.91754,
    260570: 0.02119,
    260580: 0.00282,
    270590: 1.0,
    280580: 0.680769,
    280600: 0.262231,
    280610: 0.011399,
    280620: 0.036345,
    280640: 0.009256,
    290630: 0.6915,
    290650: 0.3085,
    300640: 0.4917,
    300660: 0.2773,
    300670: 0.0404,
    300680: 0.1845,
    300700: 0.0061,
    310690: 0.60108,
    310710: 0.39892,
    320700: 0.2052,
    320720: 0.2745,
    320730: 0.0776,
    320740: 0.3652,
    320760: 0.0775,
    330750: 1.0,
    340740: 0.0086,
    340760: 0.0923,
    340770: 0.076,
    340780: 0.2369,
    340800: 0.498,
    340820: 0.0882,
    350790: 0.50686,
    350810: 0.49314,
    360780: 0.00355,
    360800: 0.02286,
    360820: 0.11593,
    360830: 0.115,
    360840: 0.56987,
    360860: 0.17279,
    370850: 0.7217,
    370870: 0.2783,
    380840: 0.0056,
    380860: 0.0986,
    380870: 0.07,
    380880: 0.8258,
    390890: 1.0,
    400900: 0.5145,
    400910: 0.1122,
    400920: 0.1715,
    400940: 0.1738,
    400960: 0.028,
    410930: 1.0,
    420920: 0.14649,
    420940: 0.09187,
    420950: 0.15873,
    420960: 0.16673,
    420970: 0.09582,
    420980: 0.24292,
    421000: 0.09744,
    440960: 0.0554,
    440980: 0.0187,
    440990: 0.1276,
    441000: 0.126,
    441010: 0.1706,
    441020: 0.3155,
    441040: 0.1862,
    451030: 1.0,
    461020: 0.0102,
    461040: 0.1114,
    461050: 0.2233,
    461060: 0.2733,
    461080: 0.2646,
    461100: 0.1172,
    471070: 0.51839,
    471090: 0.48161,
    481060: 0.01245,
    481080: 0.00888,
    481100: 0.1247,
    481110: 0.12795,
    481120: 0.24109,
    481130: 0.12227,
    481140: 0.28754,
    481160: 0.07512,
    491130: 0.04281,
    491150: 0.95719,
    501120: 0.0097,
    501140: 0.0066,
    501150: 0.0034,
    501160: 0.1454,
    501170: 0.0768,
    501180: 0.2422,
    501190: 0.0859,
    501200: 0.3258,
    501220: 0.0463,
    501240: 0.0579,
    511210: 0.5721,
    511230: 0.4279,
    521200: 0.0009,
    521220: 0.0255,
    521230: 0.0089,
    521240: 0.0474,
    521250: 0.0707,
    521260: 0.1884,
    521280: 0.3174,
    521300: 0.3408,
    531270: 1.0,
    541240: 0.00095,
    541260: 0.00089,
    541280: 0.0191,
    541290: 0.26401,
    541300: 0.04071,
    541310: 0.21232,
    541320: 0.26909,
    541340: 0.10436,
    541360: 0.08857,
    551330: 1.0,
    561300: 0.0011,
    561320: 0.001,
    561340: 0.0242,
    561350: 0.0659,
    561360: 0.0785,
    561370: 0.1123,
    561380: 0.717,
    571380: 0.0008881,
    571390: 0.9991119,
    581360: 0.00186,
    581380: 0.00251,
    581400: 0.88449,
    581420: 0.11114,
    591410: 1.0,
    601420: 0.27153,
    601430: 0.12173,
    601440: 0.23798,
    601450: 0.08293,
    601460: 0.17189,
    601480: 0.05756,
    601500: 0.05638,
    621440: 0.0308,
    621470: 0.15,
    621480: 0.1125,
    621490: 0.1382,
    621500: 0.0737,
    621520: 0.2674,
    621540: 0.2274,
    631510: 0.4781,
    631530: 0.5219,
    641520: 0.002,
    641540: 0.0218,
    641550: 0.148,
    641560: 0.2047,
    641570: 0.1565,
    641580: 0.2484,
    641600: 0.2186,
    651590: 1.0,
    661560: 0.00056,
    661580: 0.00095,
    661600: 0.02329,
    661610: 0.18889,
    661620: 0.25475,
    661630: 0.24896,
    661640: 0.2826,
    671650: 1.0,
    681620: 0.00139,
    681640: 0.01601,
    681660: 0.33503,
    681670: 0.22869,
    681680: 0.26978,
    681700: 0.1491,
    691690: 1.0,
    701680: 0.00123,
    701700: 0.02982,
    701710: 0.14086,
    701720: 0.21686,
    701730: 0.16103,
    701740: 0.32025,
    701760: 0.12995,
    711750: 0.97401,
    711760: 0.02599,
    721740: 0.0016,
    721760: 0.0526,
    721770: 0.186,
    721780: 0.2728,
    721790: 0.1362,
    721800: 0.3508,
    731800: 0.0001201,
    731810: 0.9998799,
    741800: 0.0012,
    741820: 0.265,
    741830: 0.1431,
    741840: 0.3064,
    741860: 0.2843,
    751850: 0.374,
    751870: 0.626,
    761840: 0.0002,
    761860: 0.0159,
    761870: 0.0196,
    761880: 0.1324,
    761890: 0.1615,
    761900: 0.2626,
    761920: 0.4078,
    771910: 0.373,
    771930: 0.627,
    781900: 0.00012,
    781920: 0.00782,
    781940: 0.32864,
    781950: 0.33775,
    781960: 0.25211,
    781980: 0.07356,
    791970: 1.0,
    801960: 0.0015,
    801980: 0.1004,
    801990: 0.1694,
    802000: 0.2314,
    802010: 0.1317,
    802020: 0.2974,
    802040: 0.0682,
    812030: 0.29524,
    812050: 0.70476,
    822040: 0.014,
    822060: 0.241,
    822070: 0.221,
    822080: 0.524,
    832090: 1.0,
    902300: 0.0002,
    902320: 0.9998,
    912310: 1.0,
    922340: 5.4e-05,
    922350: 0.007204,
    922380: 0.992742,
}


def abundance_per_element():
    """
    Writes the abundance of each element isotope.

    Returns:
    --------
    * `abundance_per_element`: dictionary of dictionaries having the atomic numbers and the zam as keys respectively.
    """
    abundance_per_element = {
        expand_zam(zam)[0]: {} for zam in NATURAL_ABUNDANCE
    }
    for zam, v in NATURAL_ABUNDANCE.items():
        z, a, m = expand_zam(zam)
        abundance_per_element[z][zam] = v
    return abundance_per_element

